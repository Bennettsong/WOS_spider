CREATE DEFINER=`root`@`%` PROCEDURE `insert_data`(IN datas LONGTEXT,OUT flag INT)
BEGIN
	DECLARE CONTINUE HANDLER FOR SQLEXCEPTION,NOT FOUND,SQLWARNING SET flag=500;
	START TRANSACTION; -- 事务开始
	SET @str='REPLACE INTO China_2002(PT, AU, BA, BE, GP, AF, BF, CA, TI, SO, SE, BS, LA, DT, CT, CY, CL, SP,HO, DE, ID, AB, C1, RP, EM,RI, OI, FU, FX, CR, NR, TC, Z9, U1, U2, PU,PI, PA, SN, EI, BN, J9, JI, PD, PY, VL, `IS`, PN, SU, SI, MA, BP, EP, AR,DI, D2, EA, PG, WC, SC, GA, UT, PM, OA, HC, HP, DA) VALUES ';
	SET @str=CONCAT(@str,datas);
	PREPARE stmt FROM @str;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	IF flag=500 THEN ROLLBACK;
	ELSE SET flag=200; COMMIT;
	END IF;
    END$$

DELIMITER ;